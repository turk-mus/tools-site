<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="google-adsense-account" content="ca-pub-6286972152122784">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | ØªØ­Ø¯ÙŠØ« ÙŠÙˆÙ…ÙŠ</title>
  <meta name="description" content="ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹ÙŠØ§Ø±Ø§Øª ÙˆØ§Ù„Ø£ÙˆØ²Ø§Ù†ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø³Ø¹Ø± Ø§Ù„ØºØ±Ø§Ù… ÙˆØ§Ù„Ø£ÙˆÙ†ØµØ© ÙˆØ§Ù„Ø³Ø¨Ø§Ø¦ÙƒØŒ Ù…Ø¹ ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙŠÙˆÙ…ÙŠ.">
  <meta name="keywords" content="Ø³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø¨, Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨, Ø³Ø¨Ø§Ø¦Ùƒ Ø°Ù‡Ø¨, Ø¹ÙŠØ§Ø± 24, Ø¹ÙŠØ§Ø± 21, Ø¹ÙŠØ§Ø± 18, Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">

  <!-- Google Analytics (Ù„Ø§ ÙŠØªÙ… Ø­Ø°ÙÙ‡) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D8W8C8PYS9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D8W8C8PYS9');
  </script>

  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
      color: #333;
      transition: background 0.3s, color 0.3s;
    }
    .dark-mode { background-color: #121212; color: #eee; }
    h1 { text-align: center; color: #006c35; }
    .dark-mode h1 { color: #6ef19d; }
    p.description { text-align: center; font-size: 18px; margin-bottom: 20px; }

    .actions { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
    button {
      background: #006c35; color: white; border: none; border-radius: 20px;
      padding: 8px 15px; cursor: pointer; font-size: 14px;
    }

    table { width: 100%; max-width: 800px; margin: auto; border-collapse: collapse; margin-bottom: 40px; }
    table th, table td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    table th { background-color: #006c35; color: #fff; }
    .dark-mode table th { background-color: #1f4033; }
    .dark-mode table td { background-color: #1c1c1c; }

    .footer { text-align: center; font-size: 13px; margin-top: 20px; color: #888; }
    .home-btn {
      position: fixed; top: 15px; right: 15px; background: #006c35; color: white;
      text-decoration: none; padding: 8px 15px; border-radius: 20px; font-size: 14px;
      z-index: 1000; transition: background 0.3s;
    }
    .home-btn:hover { background: #008f4c; }
  </style>
</head>
<body>
  <button style="position: fixed; top: 15px; left: 15px;" onclick="toggleDarkMode()">ğŸŒ“ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ</button>
  <a href="home.html" class="home-btn">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>

  <h1>ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø¨ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</h1>
  <p class="description">ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ Ù„ÙƒÙ„ Ø§Ù„Ø¹ÙŠØ§Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø¨Ø§Ø¦Ùƒ Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØŒ Ù…Ø¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø±ÙŠØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ.</p>

  <div class="actions">
    <button onclick="shareData()">ğŸ”— Ù…Ø´Ø§Ø±ÙƒØ©</button>
    <button onclick="downloadCSV()">ğŸ“¥ ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù</button>
  </div>

  <div id="gold-tables">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±...</div>

  <div class="footer">
    Ø§Ù„Ù…ØµØ¯Ø±: <code>gold.json</code> |
    Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: <span id="update-time">...</span>
  </div>

  <script>
    let csvContent = "Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„Ø³Ø¹Ø±/ØºØ±Ø§Ù…,Ø§Ù„Ø³Ø¹Ø±/Ø£ÙˆÙ†ØµØ©\n";

    function formatNum(num) {
      return Number(num).toLocaleString("ar-EG", { maximumFractionDigits: 2 });
    }

    async function fetchGoldPrices() {
      try {
        // âœ… Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† gold.json Ø§Ù„Ù…ÙÙˆÙ„Ù‘Ø¯ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù€ Deploy + ÙƒØ³Ø± Ø§Ù„ÙƒØ§Ø´
        const response = await fetch("gold.json?ts=" + Date.now(), { cache: 'no-cache' });
        if (!response.ok) throw new Error('HTTP ' + response.status);

        const data = await response.json();
        const updatedAt = new Date(data.last_updated);
        const grams = data.grams || {};
        const pricePerOunceSar = data.price_ounce_sar;

        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹ÙŠØ§Ø±Ø§Øª
        const karats = [
          { name: "Ø¹ÙŠØ§Ø± 24", key: "24" },
          { name: "Ø¹ÙŠØ§Ø± 22", key: "22" },
          { name: "Ø¹ÙŠØ§Ø± 21", key: "21" },
          { name: "Ø¹ÙŠØ§Ø± 18", key: "18" },
          { name: "Ø¹ÙŠØ§Ø± 14", key: "14" }
        ];

        csvContent = "Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„Ø³Ø¹Ø±/ØºØ±Ø§Ù…,Ø§Ù„Ø³Ø¹Ø±/Ø£ÙˆÙ†ØµØ©\n";
        let table1 = `<table><thead><tr><th>Ø§Ù„Ø¹ÙŠØ§Ø±</th><th>Ø§Ù„Ø³Ø¹Ø±/ØºØ±Ø§Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±/Ø£ÙˆÙ†ØµØ©</th></tr></thead><tbody>`;
        karats.forEach(k => {
          const gram = grams[k.key];
          const ounce = pricePerOunceSar * (parseInt(k.key,10) / 24);
          table1 += `<tr><td>${k.name}</td><td>${formatNum(gram)} Ø±ÙŠØ§Ù„</td><td>${formatNum(ounce)} Ø±ÙŠØ§Ù„</td></tr>`;
          csvContent += `${k.name},${Number(gram).toFixed(2)},${Number(ounce).toFixed(2)}\n`;
        });
        table1 += `</tbody></table>`;

        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¨Ø§Ø¦Ùƒ (Ø¹ÙŠØ§Ø± 24)
        let table2 = `<table><thead><tr><th>ÙˆØ²Ù† Ø§Ù„Ø³Ø¨ÙŠÙƒØ©</th><th>Ø³Ø¹Ø± Ø§Ù„Ø³Ø¨ÙŠÙƒØ© (Ø¹ÙŠØ§Ø± 24)</th></tr></thead><tbody>`;
        [1, 5, 10, 20, 50, 100, 1000].forEach(weight => {
          const total = (grams["24"] || 0) * weight;
          table2 += `<tr><td>${weight} ØºØ±Ø§Ù…</td><td>${formatNum(total)} Ø±ÙŠØ§Ù„</td></tr>`;
          csvContent += `Ø³Ø¨ÙŠÙƒØ© ${weight} ØºØ±Ø§Ù…,${Number(total).toFixed(2)},-\n`;
        });
        table2 += `</tbody></table>`;

        document.getElementById("gold-tables").innerHTML = table1 + table2;

        // Ø¹Ø±Ø¶ ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« ÙƒÙ…Ø§ Ù‡Ùˆ Ù…Ø®Ø²Ù‘Ù† Ø¯Ø§Ø®Ù„ gold.json (ÙŠÙØ¹Ø±ÙØ¶ Ø¨ØªÙˆÙ‚ÙŠØª Ø¬Ù‡Ø§Ø² Ø§Ù„Ø²Ø§Ø¦Ø±)
        document.getElementById("update-time").textContent =
          updatedAt.toLocaleString("ar-EG", { hour12: false });

      } catch (err) {
        document.getElementById("gold-tables").innerHTML = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±.";
        document.getElementById("update-time").textContent = 'â€”';
        console.error(err);
      }
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    function downloadCSV() {
      const blob = new Blob(["\uFEFF" + csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    function shareData() {
      if (navigator.share) {
        navigator.share({
          title: "Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©",
          text: "Ø§Ø·Ù„Ø¹ Ø¹Ù„Ù‰ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.",
          url: window.location.href
        });
      } else {
        alert("Ù…ÙŠØ²Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­.");
      }
    }

    // Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„
    fetchGoldPrices();
  </script>
</body>
</html>
